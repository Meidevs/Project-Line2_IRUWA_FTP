<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link href="https://mostfeel.site:8888/static/stylesheets/css/style.css" type="text/css" rel="stylesheet" />
  <!-- Favicon -->
  <!-- Favicon and Touch Icons -->
  <link href="https://mostfeel.site:8888/static/images/web_images/favicon.png" rel="shortcut icon" type="image/png">
  <link href="https://mostfeel.site:8888/static/images/web_images/apple-touch-icon.png" rel="apple-touch-icon">
  <link href="https://mostfeel.site:8888/static/images/web_images/apple-touch-icon-72x72.png" rel="apple-touch-icon"
    sizes="72x72">
  <link href="https://mostfeel.site:8888/static/images/web_images/apple-touch-icon-114x114.png" rel="apple-touch-icon"
    sizes="114x114">
  <link href="https://mostfeel.site:8888/static/images/web_images/apple-touch-icon-144x144.png" rel="apple-touch-icon"
    sizes="144x144">
  <title>Classifly - Classified Ads HTML Template</title>
</head>

<body>

  <!-- =======================
	header Start-->
  <header class="header-static navbar-sticky navbar-light shadow">
    <!-- Navbar top start-->
    <div class="navbar-top d-none d-lg-block">
      <div class="container">
        <div class="d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
          </div>

          <div class="d-flex align-items-center">
            <div class="dropdown"> <a class="dropdown-toggle" href="#" role="button" id="dropdownAccount"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i
                  class="far fa-user mr-2"></i>Account </a>
              <div class="dropdown-menu mt-2 shadow" aria-labelledby="dropdownAccount"><a class="dropdown-item"
                  href="#">Logout</a></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Navbar top End-->

    <!-- Logo Nav Start -->
    <nav class="navbar navbar-expand-lg">
      <div class="container">
        <!-- Logo -->
        <a class="navbar-brand" href="https://mostfeel.site:8888/admin/main"> <img
            src="https://mostfeel.site:8888/static/images/web_images/logo.png" style="width: 60px; height: 60px;"
            alt="iruwa"> <strong>IRUWA</strong> </a>
        <!-- Menu opener button -->
        <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#navbarCollapse"
          aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"> <span
            class="navbar-toggler-icon"> </span> </button>
        <!-- Main Menu Start -->
        <div class="collapse navbar-collapse" id="navbarCollapse">
          <ul class="navbar-nav ml-auto">
            <!-- Menu item 1 Demos-->
            <li class="nav-item active">
              <a class="nav-link" href="https://mostfeel.site:8888/admin/main">홈</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://mostfeel.site:8888/admin/list">업체 목록</a>
            </li>
            <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" href="#" id="docMenu"
                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">대쉬보드</a>
              <ul class="dropdown-menu" aria-labelledby="docMenu">
                <li><a class="dropdown-item" href="dashboard.html">카테고리 관리</a></li>
                <li><a class="dropdown-item" href="dashboard-myads.html">공지사항 관리</a></li>
                <li><a class="dropdown-item" href="dashboard-myfavourites.html">프리미엄 광고 관리</a></li>
                <li><a class="dropdown-item" href="dashboard-offermessages.html">검색 금지어 관리</a></li>
                <li><a class="dropdown-item" href="dashboard-payments.html">이미지 관리</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <!-- Main Menu End -->
      </div>
    </nav>
    <!-- Logo Nav End -->
  </header>
  <!-- =======================
	header End-->

  <!-- =======================
	Banner innerpage -->
  <div class="innerpage-banner left bg-overlay-dark-7 py-7"
    style="background:url(https://mostfeel.site:8888/static/images/web_images/07.jpg) repeat; background-size:cover;">
    <div class="container">
      <div class="row all-text-white">
        <div class="col-md-12 align-self-center">
          <h1 class="innerpage-title">카테고리 관리</h1>
          <h6 class="subtitle">카테고리를 등록/삭제할 수 있는 관리자 페이지입니다</h6>
        </div>
      </div>
    </div>
  </div>
  <!-- =======================
	Banner innerpage -->

  <section class="pt80 pb80">
    <div class="container">
      <div class="row">
        <div class="col-sm-12 mb-5">
          <h5 class="text-center mb-4">카테고리 리스트</h5>
          <div class="table-responsive-sm">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th scope="col">번호</th>
                  <th scope="col">아이콘</th>
                  <th scope="col">카테고리 명</th>
                  <th scope="col">Url</th>
                  <th scope="col">삭제</th>
                </tr>
              </thead>
              <tbody id="categories-tbody">
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- =======================
	Form -->
  <section class="pt80 pb80 eleform">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <form enctype="multipart/form-data">
            <div class="form-group">
              <input class="form-control" id="category_name" name="category_name" type="text" placeholder="카테고리 명" value="">
            </div>
            <div class="form-group">
              <input class="form-control" id="icon_name" name="icon_name" type="text" placeholder="아이콘 명(영문)" value="">
            </div>
            <div class="input-group-prepend">
              <span class="input-group-text">Upload</span>
            </div>
            <div class="custom-file">
              <input type="file" class="custom-file-input" id="inputGroupFile01">
              <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
            </div>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- =======================
	Form -->

  <div class="gradient-overlay-half-primary-v1">
    <div class="bg-img-hero"
      style="background-image: url(https://mostfeel.site:8888/static/images/web_images/bg2.png);">
      <div class="container">
        <div class="row align-items-lg-center text-lg-left space-2">
          <div class="col-lg-12 text-lg-right">
            <a class="btn btn-purple mb-2 mb-sm-0 mr-sm-2" type="submit" onclick="uploadCategory()">카테고리 저장</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer class="main-footer">
    <div class="footer-content">
      <div class="container">
        <div class="row">
          <div class=" col-xl-3 col-xl-3 col-md-3 col-sm-6 col-xs-12 col-12">
            <div class="footer-col row">
              <div class="col-sm-12 col-xs-6 col-xxs-12 no-padding-lg">
                <div class="mobile-app-content">
                  <h4 class="footer-title">Mobile Apps</h4>
                  <div class="row ">
                    <div class="col-6  "> <a class="app-icon" target="_blank" href="https://itunes.apple.com/"> <img
                          src="https://mostfeel.site:8888/static/images/web_images/app_store_badge.svg"
                          alt="Available on the App Store"> </a> </div>
                    <div class="col-6  "> <a class="app-icon" target="_blank" href="https://play.google.com/store/">
                        <img src="https://mostfeel.site:8888/static/images/web_images/google-play-badge.svg"
                          alt="Available on the App Store"> </a> </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div style="clear: both"></div>
          <div class="col-xl-12">
            <div class=" text-center paymanet-method-logo">
              <div class="copy-info text-center"> © 2019 Classifly. All Rights Reserved. </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://mostfeel.site:8888/static/javascripts/js/jquery.min.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/popper.min.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/functions.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/owl.carousel.min.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/slick.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/swiper.min.js" type="text/javascript"></script>
  <script src="https://mostfeel.site:8888/static/javascripts/js/main.js" type="text/javascript"></script>

  <script>
    $(document).ready(() => {
      getCategories();
    })

    getCategories = async () => {
      const resCategories = await fetch('https://mostfeel.site:8888/admin/category/categories', {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json'
        }
      });
      let json = await resCategories.json();
      if (resCategories.ok) {
        var my_tbody = document.getElementById('categories-tbody');
        json.map((data, index) => {
          var row = my_tbody.insertRow(my_tbody.rows.length);
          var cell1 = row.insertCell(0);
          var cell2 = row.insertCell(1);
          var cell3 = row.insertCell(2);
          var cell4 = row.insertCell(3);
          var cell5 = row.insertCell(4);
          cell1.innerHTML = index + 1;
          cell2.innerHTML = `<img src="` + data.uri + `" style="width : 50px; height : 50px; border-radius : 50px; padding : 10px; background-color : #15bac1;">`
          cell3.innerHTML = data.category_name;
          cell4.innerHTML = data.uri;
          cell5.innerHTML = `<button type="button" onclick="deleteCategory(` + data.category_seq + `)" style="border-radius : 10px; background-color : #ffffff">삭제</button>`
        })
      }
    }

    uploadCategory = async () => {
      var formData = new FormData();
      var category_name = document.getElementById('category_name').value;
      var icon_name = document.getElementById('icon_name').value;
      var fileField = document.querySelector("input[type='file']");
      console.log('category_name', category_name);
      console.log('category_icon_name', category_icon_name);
      console.log('fileField', fileField);
      formData.append("category_name", category_name)
      formData.append("icon_name", icon_name)
      formData.append("image", fileField.files[0]);
      try {
        let response = await fetch('https://mostfeel.site:8888/admin/category/upload', {
          method : 'POST',
          headers : {
            'Cotent-Type' : 'multipart/form-data'
          },
          body : formData,
        })
        if (response.ok) {
          alert('저장되었습니다.')
        }
      } catch (err) {
        console.log(err)
      }
    }
  </script>
</body>

</html>